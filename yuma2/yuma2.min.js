var h=void 0,j=!0,k=null,l=!1,o,q=this;
function r(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ba(a){var b=r(a);return"array"==b||"object"==b&&"number"==typeof a.length}function s(a){return"string"==typeof a}function ca(a){var b=typeof a;return"object"==b&&a!=k||"function"==b}function t(a){return a[da]||(a[da]=++ea)}var da="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),ea=0;
function fa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}function u(a,b){function c(){}c.prototype=b.prototype;a.A=b.prototype;a.prototype=new c};function ga(a){this.text="";this.shape=a}function ha(a){this.type="rectangle";this.c=a};function ia(a){if(!ja.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(ka,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(la,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(ma,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(na,"&quot;"));return a}var ka=/&/g,la=/</g,ma=/>/g,na=/\"/g,ja=/[&<>\"]/,oa={};function pa(a){return oa[a]||(oa[a]=(""+a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()}))};var w=Array.prototype,qa=w.indexOf?function(a,b,c){return w.indexOf.call(a,b,c)}:function(a,b,c){c=c==k?0:0>c?Math.max(0,a.length+c):c;if(s(a))return!s(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ra=w.forEach?function(a,b,c){w.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=s(a)?a.split(""):a,e=0;e<d;e++)e in f&&b.call(c,f[e],e,a)};function sa(a){return w.concat.apply(w,arguments)}
function ta(a){if("array"==r(a))return sa(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function ua(a,b,c){return 2>=arguments.length?w.slice.call(a,b):w.slice.call(a,b,c)}function va(a,b){w.sort.call(a,b||wa)}function wa(a,b){return a>b?1:a<b?-1:0};var x,xa,y,ya,za;function Aa(){return q.navigator?q.navigator.userAgent:k}function z(){return q.navigator}ya=y=xa=x=l;var B;if(B=Aa()){var Ba=z();x=0==B.indexOf("Opera");xa=!x&&-1!=B.indexOf("MSIE");y=!x&&-1!=B.indexOf("WebKit");ya=!x&&!y&&"Gecko"==Ba.product}var Ca=x,C=xa,D=ya,E=y,Da=z();za=-1!=(Da&&Da.platform||"").indexOf("Mac");var Ea=!!z()&&-1!=(z().appVersion||"").indexOf("X11"),Fa;
a:{var F="",G;if(Ca&&q.opera)var Ga=q.opera.version,F="function"==typeof Ga?Ga():Ga;else if(D?G=/rv\:([^\);]+)(\)|;)/:C?G=/MSIE\s+([^\);]+)(\)|;)/:E&&(G=/WebKit\/(\S+)/),G)var Ha=G.exec(Aa()),F=Ha?Ha[1]:"";if(C){var Ia,Ja=q.document;Ia=Ja?Ja.documentMode:h;if(Ia>parseFloat(F)){Fa=""+Ia;break a}}Fa=F}var Ka={};
function H(a){var b;if(!(b=Ka[a])){b=0;for(var c=(""+Fa).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(c.length,d.length),e=0;0==b&&e<f;e++){var g=c[e]||"",i=d[e]||"",n=RegExp("(\\d*)(\\D*)","g"),p=RegExp("(\\d*)(\\D*)","g");do{var v=n.exec(g)||["","",""],m=p.exec(i)||["","",""];if(0==v[0].length&&0==m[0].length)break;b=((0==v[1].length?0:parseInt(v[1],10))<(0==m[1].length?0:parseInt(m[1],10))?-1:(0==v[1].length?0:parseInt(v[1],
10))>(0==m[1].length?0:parseInt(m[1],10))?1:0)||((0==v[2].length)<(0==m[2].length)?-1:(0==v[2].length)>(0==m[2].length)?1:0)||(v[2]<m[2]?-1:v[2]>m[2]?1:0)}while(0==b)}b=Ka[a]=0<=b}return b}var La={};function I(){return La[9]||(La[9]=C&&!!document.documentMode&&9<=document.documentMode)};var Ma,Na=!C||I();!D&&!C||C&&I()||D&&H("1.9.1");C&&H("9");function Oa(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=ua(arguments,1),f;f=c;for(var e=0,g=0;g<d.length;g++)0<=qa(f,d[g])||(f.push(d[g]),e++);f=e==d.length;a.className=c.join(" ");return f};function J(a,b){this.x=a!==h?a:0;this.y=b!==h?b:0};function K(a,b){this.width=a;this.height=b}K.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};K.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Pa(a,b){for(var c in a)b.call(h,a[c],c,a)}var Qa="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function Ra(a,b){for(var c,d,f=1;f<arguments.length;f++){d=arguments[f];for(c in d)a[c]=d[c];for(var e=0;e<Qa.length;e++)c=Qa[e],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function Sa(a,b){Pa(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Ta?a.setAttribute(Ta[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}var Ta={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};
function L(a,b,c){var d=arguments,f=document,e=d[0],g=d[1];if(!Na&&g&&(g.name||g.type)){e=["<",e];g.name&&e.push(' name="',ia(g.name),'"');if(g.type){e.push(' type="',ia(g.type),'"');var i={};Ra(i,g);g=i;delete g.type}e.push(">");e=e.join("")}e=f.createElement(e);g&&(s(g)?e.className=g:"array"==r(g)?Oa.apply(k,[e].concat(g)):Sa(e,g));2<d.length&&Ua(f,e,d);return e}
function Ua(a,b,c){function d(c){c&&b.appendChild(s(c)?a.createTextNode(c):c)}for(var f=2;f<c.length;f++){var e=c[f];ba(e)&&!(ca(e)&&0<e.nodeType)?ra(Va(e)?ta(e):e,d):d(e)}}function Wa(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function Va(a){if(a&&"number"==typeof a.length){if(ca(a))return"function"==typeof a.item||"string"==typeof a.item;if("function"==r(a))return"function"==typeof a.item}return l}function M(a){this.u=a||q.document||document}M.prototype.createElement=function(a){return this.u.createElement(a)};
M.prototype.createTextNode=function(a){return this.u.createTextNode(a)};M.prototype.appendChild=function(a,b){a.appendChild(b)};function N(a,b,c){s(b)?Xa(a,c,b):Pa(b,fa(Xa,a))}function Xa(a,b,c){a.style[pa(c)]=b}function O(a,b){var c,d,f=D&&(za||Ea)&&H("1.9");b instanceof J?(c=b.x,d=b.y):(c=b,d=h);a.style.left=P(c,f);a.style.top=P(d,f)}function Ya(a,b){var c;if(b instanceof K)c=b.height,b=b.width;else throw Error("missing height argument");a.style.width=P(b,j);a.style.height=P(c,j)}function P(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function Za(a){var b;a:{b=9==a.nodeType?a:a.ownerDocument||a.document;if(b.defaultView&&b.defaultView.getComputedStyle&&(b=b.defaultView.getComputedStyle(a,k))){b=b.display||b.getPropertyValue("display");break a}b=""}if("none"!=(b||(a.currentStyle?a.currentStyle.display:k)||a.style&&a.style.display))return $a(a);b=a.style;var c=b.display,d=b.visibility,f=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=$a(a);b.display=c;b.position=f;b.visibility=d;return a}
function $a(a){var b=a.offsetWidth,c=a.offsetHeight,d=E&&!b&&!c;return(b===h||d)&&a.getBoundingClientRect?(b=a.getBoundingClientRect(),C&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop),new K(b.right-b.left,b.bottom-b.top)):new K(b,c)}function Q(a,b){var c=a.style;"opacity"in c?c.opacity=b:"MozOpacity"in c?c.MozOpacity=b:"filter"in c&&(c.filter=""===b?"":"alpha(opacity="+100*b+")")};!C||I();var ab=!C||I();C&&H("8");!E||H("528");D&&H("1.9b")||C&&H("8")||Ca&&H("9.5")||E&&H("528");!D||H("8");function R(){}R.prototype.t=l;R.prototype.j=function(){this.t||(this.t=j,this.e())};R.prototype.e=function(){this.B&&bb.apply(k,this.B)};function bb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ba(d)?bb.apply(k,d):d&&"function"==typeof d.j&&d.j()}};function S(a,b){this.type=a;this.currentTarget=this.target=b}u(S,R);S.prototype.e=function(){delete this.type;delete this.target;delete this.currentTarget};S.prototype.f=l;S.prototype.m=j;function cb(a){cb[" "](a);return a}cb[" "]=function(){};function T(a,b){a&&this.k(a,b)}u(T,S);o=T.prototype;o.target=k;o.relatedTarget=k;o.offsetX=0;o.offsetY=0;o.clientX=0;o.clientY=0;o.screenX=0;o.screenY=0;o.button=0;o.keyCode=0;o.charCode=0;o.ctrlKey=l;o.altKey=l;o.shiftKey=l;o.metaKey=l;
o.k=function(a,b){var c=this.type=a.type;S.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(D){var f;a:{try{cb(d.nodeName);f=j;break a}catch(e){}f=l}f||(d=k)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=E||a.offsetX!==h?a.offsetX:a.layerX;this.offsetY=E||a.offsetY!==h?a.offsetY:a.layerY;this.clientX=a.clientX!==h?a.clientX:a.pageX;this.clientY=a.clientY!==h?a.clientY:a.pageY;this.screenX=a.screenX||
0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;delete this.m;delete this.f};o.e=function(){T.A.e.call(this);this.relatedTarget=this.currentTarget=this.target=k};function db(){}var eb=0;o=db.prototype;o.key=0;o.g=l;o.r=l;o.k=function(a,b,c,d,f,e){if("function"==r(a))this.v=j;else if(a&&a.handleEvent&&"function"==r(a.handleEvent))this.v=l;else throw Error("Invalid listener argument");this.h=a;this.z=b;this.src=c;this.type=d;this.capture=!!f;this.o=e;this.r=l;this.key=++eb;this.g=l};o.handleEvent=function(a){return this.v?this.h.call(this.o||this.src,a):this.h.handleEvent.call(this.h,a)};var U={},V={},W={},X={};
function Y(a,b,c,d,f){if(b)if("array"==r(b))for(var e=0;e<b.length;e++)Y(a,b[e],c,d,f);else{var d=!!d,g=V;b in g||(g[b]={b:0,a:0});g=g[b];d in g||(g[d]={b:0,a:0},g.b++);var g=g[d],i=t(a),n;g.a++;if(g[i]){n=g[i];for(e=0;e<n.length;e++)if(g=n[e],g.h==c&&g.o==f){if(g.g)break;return}}else n=g[i]=[],g.b++;e=fb();e.src=a;g=new db;g.k(c,e,a,b,d,f);c=g.key;e.key=c;n.push(g);U[c]=g;W[i]||(W[i]=[]);W[i].push(g);a.addEventListener?(a==q||!a.s)&&a.addEventListener(b,e,d):a.attachEvent(b in X?X[b]:X[b]="on"+b,
e)}else throw Error("Invalid event type");}function fb(){var a=gb,b=ab?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function hb(a,b,c,d,f){if("array"==r(b))for(var e=0;e<b.length;e++)hb(a,b[e],c,d,f);else{d=!!d;a:{e=V;if(b in e&&(e=e[b],d in e&&(e=e[d],a=t(a),e[a]))){a=e[a];break a}a=k}if(a)for(e=0;e<a.length;e++)if(a[e].h==c&&a[e].capture==d&&a[e].o==f){Z(a[e].key);break}}}
function Z(a){if(U[a]){var b=U[a];if(!b.g){var c=b.src,d=b.type,f=b.z,e=b.capture;c.removeEventListener?(c==q||!c.s)&&c.removeEventListener(d,f,e):c.detachEvent&&c.detachEvent(d in X?X[d]:X[d]="on"+d,f);c=t(c);f=V[d][e][c];if(W[c]){var g=W[c],i=qa(g,b);0<=i&&w.splice.call(g,i,1);0==g.length&&delete W[c]}b.g=j;f.w=j;ib(d,e,c,f);delete U[a]}}}
function ib(a,b,c,d){if(!d.l&&d.w){for(var f=0,e=0;f<d.length;f++)d[f].g?d[f].z.src=k:(f!=e&&(d[e]=d[f]),e++);d.length=e;d.w=l;0==e&&(delete V[a][b][c],V[a][b].b--,0==V[a][b].b&&(delete V[a][b],V[a].b--),0==V[a].b&&delete V[a])}}function jb(a){var b,c=0,d=b==k;b=!!b;if(a==k)Pa(W,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)Z(f.key),c++}});else if(a=t(a),W[a])for(var a=W[a],f=a.length-1;0<=f;f--){var e=a[f];if(d||b==e.capture)Z(e.key),c++}}
function $(a,b,c,d,f){var e=1,b=t(b);if(a[b]){a.a--;a=a[b];a.l?a.l++:a.l=1;try{for(var g=a.length,i=0;i<g;i++){var n=a[i];n&&!n.g&&(e&=kb(n,f)!==l)}}finally{a.l--,ib(c,d,b,a)}}return Boolean(e)}function kb(a,b){var c=a.handleEvent(b);a.r&&Z(a.key);return c}
function gb(a,b){if(!U[a])return j;var c=U[a],d=c.type,f=V;if(!(d in f))return j;var f=f[d],e,g;if(!ab){var i;if(!(i=b))a:{i=["window","event"];for(var n=q;e=i.shift();)if(n[e]!=k)n=n[e];else{i=k;break a}i=n}e=i;i=j in f;n=l in f;if(i){if(0>e.keyCode||e.returnValue!=h)return j;a:{var p=l;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(v){p=j}if(p||e.returnValue==h)e.returnValue=j}}p=new T;p.k(e,this);e=j;try{if(i){for(var m=[],aa=p.currentTarget;aa;aa=aa.parentNode)m.push(aa);g=f[j];g.a=g.b;for(var A=
m.length-1;!p.f&&0<=A&&g.a;A--)p.currentTarget=m[A],e&=$(g,m[A],d,j,p);if(n){g=f[l];g.a=g.b;for(A=0;!p.f&&A<m.length&&g.a;A++)p.currentTarget=m[A],e&=$(g,m[A],d,l,p)}}else e=kb(c,p)}finally{m&&(m.length=0),p.j()}return e}d=new T(b,this);try{e=kb(c,d)}finally{d.j()}return e}var lb=0;function mb(){}u(mb,R);o=mb.prototype;o.s=j;o.p=k;o.addEventListener=function(a,b,c,d){Y(this,a,b,c,d)};o.removeEventListener=function(a,b,c,d){hb(this,a,b,c,d)};
o.dispatchEvent=function(a){var b=a.type||a,c=V;if(b in c){if(s(a))a=new S(a,this);else if(a instanceof S)a.target=a.target||this;else{var d=a,a=new S(b,this);Ra(a,d)}var d=1,f,c=c[b],b=j in c,e;if(b){f=[];for(e=this;e;e=e.p)f.push(e);e=c[j];e.a=e.b;for(var g=f.length-1;!a.f&&0<=g&&e.a;g--)a.currentTarget=f[g],d&=$(e,f[g],a.type,j,a)&&a.m!=l}if(l in c)if(e=c[l],e.a=e.b,b)for(g=0;!a.f&&g<f.length&&e.a;g++)a.currentTarget=f[g],d&=$(e,f[g],a.type,l,a)&&a.m!=l;else for(f=this;!a.f&&f&&e.a;f=f.p)a.currentTarget=
f,d&=$(e,f,a.type,l,a)&&a.m!=l;a=Boolean(d)}else a=j;return a};o.e=function(){mb.A.e.call(this);jb(this);this.p=k};function nb(a,b){this.x=a;this.y=b}function ob(a,b,c,d){0<c?(this.x=a,this.width=c):(this.x=a+c,this.width=-c);0<d?(this.y=b,this.height=d):(this.y=b+d,this.height=-d)}ob.prototype.size=function(){return this.width*this.height};var pb="new_annotation_selection_"+lb++;function qb(a){var b=a.getContext("2d");b.lineWidth=1;b.strokeStyle="#ffffff";var c=this;Y(a,"mousemove",function(d){c.selection=new ob(c.anchor.x,c.anchor.y,d.offsetX-c.anchor.x,d.offsetY-c.anchor.y);b.clearRect(0,0,a.width,a.height);b.strokeRect(c.selection.x+0.5,c.selection.y+0.5,c.selection.width,c.selection.height)});Y(a,"mouseup",function(){c.dispatchEvent(pb);b.clearRect(0,0,a.width,a.height)})}u(qb,mb);window.ImageAnnotator=function(a){var a=s(a)?document.getElementById(a):a,b=L("div","yuma-annotationlayer");N(b,"position","absolute");O(b,new J(a.offsetLeft,a.offsetTop));var c=L("div","yuma-hint","Click and Drag to Annotate");N(c,"white-space","nowrap");N(c,"position","absolute");N(c,"pointer-events","none");Q(c,0);O(c,new J(10,10));b.appendChild(c);var d=L("canvas","yuma-canvas");N(d,"position","absolute");O(d,new J(0,0));Ya(d,Za(a));Sa(d,{width:a.width,height:a.height});b.appendChild(d);var f=
L("canvas","yuma-canvas");N(f,"position","absolute");N(f,"pointer-events","none");O(f,new J(0,0));Ya(f,Za(a));Sa(f,{width:a.width,height:a.height});b.appendChild(f);Y(b,"mouseover",function(){Q(d,1);Q(c,0.8)});Y(b,"mouseout",function(){Q(d,0.4);Q(c,0)});document.body.appendChild(b);var e=new rb(d),g=new qb(f);Y(b,"mousedown",function(a){g.anchor=new nb(a.offsetX,a.offsetY);N(f,"pointer-events","auto")});Y(g,pb,function(a){a=new ga(new ha(a.target.selection));e.n.push(a);sb(e,a,"#ffffff",1);N(f,"pointer-events",
"none")})};function tb(){var a=ub,b=(Ma||(Ma=new M)).createElement("DIV");b.innerHTML=a(vb,h,h);return 1==b.childNodes.length&&(a=b.firstChild,1==a.nodeType)?a:b}var vb={};function rb(a){this.q=a;var b=this;Y(a,"mousemove",function(a){wb(b,a.offsetX,a.offsetY)});this.n=[];this.i=a.getContext("2d")}function sb(a,b,c,d){a.i.strokeStyle=c;a.i.lineWidth=d;b=b.shape;"point"!=b.type&&"polygon"!=b.type&&"rectangle"==b.type&&(b=b.c,a.i.strokeRect(b.x+0.5,b.y+0.5,b.width,b.height))}
function wb(a,b,c){a.i.clearRect(0,0,a.q.width,a.q.height);ra(a.n,function(b){sb(a,b,"#ffffff",1)});var d=[];ra(a.n,function(a){!(b<a.shape.c.x||c<a.shape.c.y||b>a.shape.c.x+a.shape.c.width||c>a.shape.c.y+a.shape.c.height)&&d.push(a)});va(d,function(a,b){return a.shape.c.size()>b.shape.c.size()});0<d.length?(sb(a,d[0],"#fff000",1.8),a.d||(a.d=tb(),document.body.appendChild(a.d)),O(a.d,new J(b+15,c+20))):a.d&&(Wa(a.d),delete a.d)};C&&H(8);"ScriptEngine"in q&&"JScript"==q.ScriptEngine()&&(q.ScriptEngineMajorVersion(),q.ScriptEngineMinorVersion(),q.ScriptEngineBuildVersion());function ub(){return'<div class="yuma-popup" style="position:absolute; pointer-events:none;">An annotation!</div>'};
