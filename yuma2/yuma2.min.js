var h=void 0,j=!0,k=null,l=!1,p,q=this;
function r(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function aa(a){var b=r(a);return"array"==b||"object"==b&&"number"==typeof a.length}function s(a){return"string"==typeof a}function ba(a){var b=typeof a;return"object"==b&&a!=k||"function"==b}function t(a){return a[ca]||(a[ca]=++da)}var ca="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),da=0;
function ea(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}function v(a,b){function c(){}c.prototype=b.prototype;a.w=b.prototype;a.prototype=new c};function fa(a){this.text="";this.shape=a}function ga(a){this.type="rectangle";this.c=a};function ha(a){if(!ia.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(ja,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(ka,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(la,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(ma,"&quot;"));return a}var ja=/&/g,ka=/</g,la=/>/g,ma=/\"/g,ia=/[&<>\"]/,na={};function oa(a){return na[a]||(na[a]=(""+a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()}))};var w=Array.prototype,pa=w.indexOf?function(a,b,c){return w.indexOf.call(a,b,c)}:function(a,b,c){c=c==k?0:0>c?Math.max(0,a.length+c):c;if(s(a))return!s(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},qa=w.forEach?function(a,b,c){w.forEach.call(a,b,c)}:function(a,b,c){for(var e=a.length,f=s(a)?a.split(""):a,d=0;d<e;d++)d in f&&b.call(c,f[d],d,a)};function ra(a){return w.concat.apply(w,arguments)}
function sa(a){if("array"==r(a))return ra(a);for(var b=[],c=0,e=a.length;c<e;c++)b[c]=a[c];return b}function ta(a,b,c){return 2>=arguments.length?w.slice.call(a,b):w.slice.call(a,b,c)}function ua(a,b){w.sort.call(a,b||va)}function va(a,b){return a>b?1:a<b?-1:0};var x,wa,y,xa,ya;function za(){return q.navigator?q.navigator.userAgent:k}function z(){return q.navigator}xa=y=wa=x=l;var B;if(B=za()){var Aa=z();x=0==B.indexOf("Opera");wa=!x&&-1!=B.indexOf("MSIE");y=!x&&-1!=B.indexOf("WebKit");xa=!x&&!y&&"Gecko"==Aa.product}var Ba=x,C=wa,D=xa,E=y,Ca=z();ya=-1!=(Ca&&Ca.platform||"").indexOf("Mac");var Da=!!z()&&-1!=(z().appVersion||"").indexOf("X11"),Ea;
a:{var F="",G;if(Ba&&q.opera)var Fa=q.opera.version,F="function"==typeof Fa?Fa():Fa;else if(D?G=/rv\:([^\);]+)(\)|;)/:C?G=/MSIE\s+([^\);]+)(\)|;)/:E&&(G=/WebKit\/(\S+)/),G)var Ga=G.exec(za()),F=Ga?Ga[1]:"";if(C){var Ha,Ia=q.document;Ha=Ia?Ia.documentMode:h;if(Ha>parseFloat(F)){Ea=""+Ha;break a}}Ea=F}var Ja={};
function H(a){var b;if(!(b=Ja[a])){b=0;for(var c=(""+Ea).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(c.length,e.length),d=0;0==b&&d<f;d++){var g=c[d]||"",i=e[d]||"",n=RegExp("(\\d*)(\\D*)","g"),o=RegExp("(\\d*)(\\D*)","g");do{var u=n.exec(g)||["","",""],m=o.exec(i)||["","",""];if(0==u[0].length&&0==m[0].length)break;b=((0==u[1].length?0:parseInt(u[1],10))<(0==m[1].length?0:parseInt(m[1],10))?-1:(0==u[1].length?0:parseInt(u[1],
10))>(0==m[1].length?0:parseInt(m[1],10))?1:0)||((0==u[2].length)<(0==m[2].length)?-1:(0==u[2].length)>(0==m[2].length)?1:0)||(u[2]<m[2]?-1:u[2]>m[2]?1:0)}while(0==b)}b=Ja[a]=0<=b}return b}var Ka={};function I(){return Ka[9]||(Ka[9]=C&&!!document.documentMode&&9<=document.documentMode)};var La=!C||I();!D&&!C||C&&I()||D&&H("1.9.1");C&&H("9");function Ma(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var e=ta(arguments,1),f;f=c;for(var d=0,g=0;g<e.length;g++)0<=pa(f,e[g])||(f.push(e[g]),d++);f=d==e.length;a.className=c.join(" ");return f};function J(a,b){this.x=a!==h?a:0;this.y=b!==h?b:0};function K(a,b){this.width=a;this.height=b}K.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};K.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Na(a,b){for(var c in a)b.call(h,a[c],c,a)}var Oa="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function Pa(a,b){for(var c,e,f=1;f<arguments.length;f++){e=arguments[f];for(c in e)a[c]=e[c];for(var d=0;d<Oa.length;d++)c=Oa[d],Object.prototype.hasOwnProperty.call(e,c)&&(a[c]=e[c])}};function Qa(a,b){Na(b,function(b,e){"style"==e?a.style.cssText=b:"class"==e?a.className=b:"for"==e?a.htmlFor=b:e in Ra?a.setAttribute(Ra[e],b):0==e.lastIndexOf("aria-",0)?a.setAttribute(e,b):a[e]=b})}var Ra={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};
function L(a,b,c){var e=arguments,f=document,d=e[0],g=e[1];if(!La&&g&&(g.name||g.type)){d=["<",d];g.name&&d.push(' name="',ha(g.name),'"');if(g.type){d.push(' type="',ha(g.type),'"');var i={};Pa(i,g);g=i;delete g.type}d.push(">");d=d.join("")}d=f.createElement(d);g&&(s(g)?d.className=g:"array"==r(g)?Ma.apply(k,[d].concat(g)):Qa(d,g));2<e.length&&Sa(f,d,e);return d}
function Sa(a,b,c){function e(c){c&&b.appendChild(s(c)?a.createTextNode(c):c)}for(var f=2;f<c.length;f++){var d=c[f];if(aa(d)&&!(ba(d)&&0<d.nodeType)){var g;a:{if(d&&"number"==typeof d.length){if(ba(d)){g="function"==typeof d.item||"string"==typeof d.item;break a}if("function"==r(d)){g="function"==typeof d.item;break a}}g=l}qa(g?sa(d):d,e)}else e(d)}};function M(a,b,c){s(b)?Ta(a,c,b):Na(b,ea(Ta,a))}function Ta(a,b,c){a.style[oa(c)]=b}function N(a,b){var c,e,f=D&&(ya||Da)&&H("1.9");b instanceof J?(c=b.x,e=b.y):(c=b,e=h);a.style.left=O(c,f);a.style.top=O(e,f)}function Ua(a,b){var c;if(b instanceof K)c=b.height,b=b.width;else throw Error("missing height argument");a.style.width=O(b,j);a.style.height=O(c,j)}function O(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function Va(a){var b;a:{b=9==a.nodeType?a:a.ownerDocument||a.document;if(b.defaultView&&b.defaultView.getComputedStyle&&(b=b.defaultView.getComputedStyle(a,k))){b=b.display||b.getPropertyValue("display");break a}b=""}if("none"!=(b||(a.currentStyle?a.currentStyle.display:k)||a.style&&a.style.display))return Wa(a);b=a.style;var c=b.display,e=b.visibility,f=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=Wa(a);b.display=c;b.position=f;b.visibility=e;return a}
function Wa(a){var b=a.offsetWidth,c=a.offsetHeight,e=E&&!b&&!c;return(b===h||e)&&a.getBoundingClientRect?(b=a.getBoundingClientRect(),C&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop),new K(b.right-b.left,b.bottom-b.top)):new K(b,c)}function P(a,b){var c=a.style;"opacity"in c?c.opacity=b:"MozOpacity"in c?c.MozOpacity=b:"filter"in c&&(c.filter=""===b?"":"alpha(opacity="+100*b+")")};!C||I();var Xa=!C||I();C&&H("8");!E||H("528");D&&H("1.9b")||C&&H("8")||Ba&&H("9.5")||E&&H("528");!D||H("8");function Q(){}Q.prototype.s=l;Q.prototype.i=function(){this.s||(this.s=j,this.d())};Q.prototype.d=function(){this.z&&Ya.apply(k,this.z)};function Ya(a){for(var b=0,c=arguments.length;b<c;++b){var e=arguments[b];aa(e)?Ya.apply(k,e):e&&"function"==typeof e.i&&e.i()}};function R(a,b){this.type=a;this.currentTarget=this.target=b}v(R,Q);R.prototype.d=function(){delete this.type;delete this.target;delete this.currentTarget};R.prototype.e=l;R.prototype.l=j;function Za(a){Za[" "](a);return a}Za[" "]=function(){};function S(a,b){a&&this.j(a,b)}v(S,R);p=S.prototype;p.target=k;p.relatedTarget=k;p.offsetX=0;p.offsetY=0;p.clientX=0;p.clientY=0;p.screenX=0;p.screenY=0;p.button=0;p.keyCode=0;p.charCode=0;p.ctrlKey=l;p.altKey=l;p.shiftKey=l;p.metaKey=l;
p.j=function(a,b){var c=this.type=a.type;R.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var e=a.relatedTarget;if(e){if(D){var f;a:{try{Za(e.nodeName);f=j;break a}catch(d){}f=l}f||(e=k)}}else"mouseover"==c?e=a.fromElement:"mouseout"==c&&(e=a.toElement);this.relatedTarget=e;this.offsetX=E||a.offsetX!==h?a.offsetX:a.layerX;this.offsetY=E||a.offsetY!==h?a.offsetY:a.layerY;this.clientX=a.clientX!==h?a.clientX:a.pageX;this.clientY=a.clientY!==h?a.clientY:a.pageY;this.screenX=a.screenX||
0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;delete this.l;delete this.e};p.d=function(){S.w.d.call(this);this.relatedTarget=this.currentTarget=this.target=k};function $a(){}var ab=0;p=$a.prototype;p.key=0;p.f=l;p.q=l;p.j=function(a,b,c,e,f,d){if("function"==r(a))this.t=j;else if(a&&a.handleEvent&&"function"==r(a.handleEvent))this.t=l;else throw Error("Invalid listener argument");this.g=a;this.v=b;this.src=c;this.type=e;this.capture=!!f;this.n=d;this.q=l;this.key=++ab;this.f=l};p.handleEvent=function(a){return this.t?this.g.call(this.n||this.src,a):this.g.handleEvent.call(this.g,a)};var T={},U={},V={},W={};
function X(a,b,c,e,f){if(b)if("array"==r(b))for(var d=0;d<b.length;d++)X(a,b[d],c,e,f);else{var e=!!e,g=U;b in g||(g[b]={b:0,a:0});g=g[b];e in g||(g[e]={b:0,a:0},g.b++);var g=g[e],i=t(a),n;g.a++;if(g[i]){n=g[i];for(d=0;d<n.length;d++)if(g=n[d],g.g==c&&g.n==f){if(g.f)break;return}}else n=g[i]=[],g.b++;d=bb();d.src=a;g=new $a;g.j(c,d,a,b,e,f);c=g.key;d.key=c;n.push(g);T[c]=g;V[i]||(V[i]=[]);V[i].push(g);a.addEventListener?(a==q||!a.r)&&a.addEventListener(b,d,e):a.attachEvent(b in W?W[b]:W[b]="on"+b,
d)}else throw Error("Invalid event type");}function bb(){var a=cb,b=Xa?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function db(a,b,c,e,f){if("array"==r(b))for(var d=0;d<b.length;d++)db(a,b[d],c,e,f);else{e=!!e;a:{d=U;if(b in d&&(d=d[b],e in d&&(d=d[e],a=t(a),d[a]))){a=d[a];break a}a=k}if(a)for(d=0;d<a.length;d++)if(a[d].g==c&&a[d].capture==e&&a[d].n==f){Y(a[d].key);break}}}
function Y(a){if(T[a]){var b=T[a];if(!b.f){var c=b.src,e=b.type,f=b.v,d=b.capture;c.removeEventListener?(c==q||!c.r)&&c.removeEventListener(e,f,d):c.detachEvent&&c.detachEvent(e in W?W[e]:W[e]="on"+e,f);c=t(c);f=U[e][d][c];if(V[c]){var g=V[c],i=pa(g,b);0<=i&&w.splice.call(g,i,1);0==g.length&&delete V[c]}b.f=j;f.u=j;eb(e,d,c,f);delete T[a]}}}
function eb(a,b,c,e){if(!e.k&&e.u){for(var f=0,d=0;f<e.length;f++)e[f].f?e[f].v.src=k:(f!=d&&(e[d]=e[f]),d++);e.length=d;e.u=l;0==d&&(delete U[a][b][c],U[a][b].b--,0==U[a][b].b&&(delete U[a][b],U[a].b--),0==U[a].b&&delete U[a])}}function fb(a){var b,c=0,e=b==k;b=!!b;if(a==k)Na(V,function(a){for(var d=a.length-1;0<=d;d--){var f=a[d];if(e||b==f.capture)Y(f.key),c++}});else if(a=t(a),V[a])for(var a=V[a],f=a.length-1;0<=f;f--){var d=a[f];if(e||b==d.capture)Y(d.key),c++}}
function Z(a,b,c,e,f){var d=1,b=t(b);if(a[b]){a.a--;a=a[b];a.k?a.k++:a.k=1;try{for(var g=a.length,i=0;i<g;i++){var n=a[i];n&&!n.f&&(d&=gb(n,f)!==l)}}finally{a.k--,eb(c,e,b,a)}}return Boolean(d)}function gb(a,b){var c=a.handleEvent(b);a.q&&Y(a.key);return c}
function cb(a,b){if(!T[a])return j;var c=T[a],e=c.type,f=U;if(!(e in f))return j;var f=f[e],d,g;if(!Xa){var i;if(!(i=b))a:{i=["window","event"];for(var n=q;d=i.shift();)if(n[d]!=k)n=n[d];else{i=k;break a}i=n}d=i;i=j in f;n=l in f;if(i){if(0>d.keyCode||d.returnValue!=h)return j;a:{var o=l;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(u){o=j}if(o||d.returnValue==h)d.returnValue=j}}o=new S;o.j(d,this);d=j;try{if(i){for(var m=[],$=o.currentTarget;$;$=$.parentNode)m.push($);g=f[j];g.a=g.b;for(var A=m.length-
1;!o.e&&0<=A&&g.a;A--)o.currentTarget=m[A],d&=Z(g,m[A],e,j,o);if(n){g=f[l];g.a=g.b;for(A=0;!o.e&&A<m.length&&g.a;A++)o.currentTarget=m[A],d&=Z(g,m[A],e,l,o)}}else d=gb(c,o)}finally{m&&(m.length=0),o.i()}return d}e=new S(b,this);try{d=gb(c,e)}finally{e.i()}return d}var hb=0;function ib(){}v(ib,Q);p=ib.prototype;p.r=j;p.o=k;p.addEventListener=function(a,b,c,e){X(this,a,b,c,e)};p.removeEventListener=function(a,b,c,e){db(this,a,b,c,e)};
p.dispatchEvent=function(a){var b=a.type||a,c=U;if(b in c){if(s(a))a=new R(a,this);else if(a instanceof R)a.target=a.target||this;else{var e=a,a=new R(b,this);Pa(a,e)}var e=1,f,c=c[b],b=j in c,d;if(b){f=[];for(d=this;d;d=d.o)f.push(d);d=c[j];d.a=d.b;for(var g=f.length-1;!a.e&&0<=g&&d.a;g--)a.currentTarget=f[g],e&=Z(d,f[g],a.type,j,a)&&a.l!=l}if(l in c)if(d=c[l],d.a=d.b,b)for(g=0;!a.e&&g<f.length&&d.a;g++)a.currentTarget=f[g],e&=Z(d,f[g],a.type,l,a)&&a.l!=l;else for(f=this;!a.e&&f&&d.a;f=f.o)a.currentTarget=
f,e&=Z(d,f,a.type,l,a)&&a.l!=l;a=Boolean(e)}else a=j;return a};p.d=function(){ib.w.d.call(this);fb(this);this.o=k};function jb(a,b){this.x=a;this.y=b}function kb(a,b,c,e){0<c?(this.x=a,this.width=c):(this.x=a+c,this.width=-c);0<e?(this.y=b,this.height=e):(this.y=b+e,this.height=-e)}kb.prototype.size=function(){return this.width*this.height};var lb="new_annotation_selection_"+hb++;function mb(a){var b=a.getContext("2d");b.lineWidth=1;b.strokeStyle="#ffffff";var c=this;X(a,"mousemove",function(e){c.selection=new kb(c.anchor.x,c.anchor.y,e.offsetX-c.anchor.x,e.offsetY-c.anchor.y);b.clearRect(0,0,a.width,a.height);b.strokeRect(c.selection.x+0.5,c.selection.y+0.5,c.selection.width,c.selection.height)});X(a,"mouseup",function(){c.dispatchEvent(lb);b.clearRect(0,0,a.width,a.height)})}v(mb,ib);window.ImageAnnotator=function(a){var a=s(a)?document.getElementById(a):a,b=L("div","yuma-annotationlayer");M(b,"position","absolute");N(b,new J(a.offsetLeft,a.offsetTop));var c=L("div","yuma-hint","Click and Drag to Annotate");M(c,"white-space","nowrap");M(c,"position","absolute");M(c,"pointer-events","none");P(c,0);N(c,new J(10,10));b.appendChild(c);var e=L("canvas","yuma-canvas");M(e,"position","absolute");N(e,new J(0,0));Ua(e,Va(a));Qa(e,{width:a.width,height:a.height});b.appendChild(e);var f=
L("canvas","yuma-canvas");M(f,"position","absolute");M(f,"pointer-events","none");N(f,new J(0,0));Ua(f,Va(a));Qa(f,{width:a.width,height:a.height});b.appendChild(f);X(b,"mouseover",function(){P(e,1);P(c,0.8)});X(b,"mouseout",function(){P(e,0.4);P(c,0)});document.body.appendChild(b);var d=new nb(e),g=new mb(f);X(b,"mousedown",function(a){g.anchor=new jb(a.offsetX,a.offsetY);M(f,"pointer-events","auto")});X(g,lb,function(a){a=new fa(new ga(a.target.selection));d.m.push(a);ob(d,a,"#ffffff",1);M(f,"pointer-events",
"none")})};function nb(a){this.p=a;var b=this;X(a,"mousemove",function(a){pb(b,a.offsetX,a.offsetY)});this.m=[];this.h=a.getContext("2d")}function ob(a,b,c,e){a.h.strokeStyle=c;a.h.lineWidth=e;b=b.shape;"point"!=b.type&&"polygon"!=b.type&&"rectangle"==b.type&&(b=b.c,a.h.strokeRect(b.x+0.5,b.y+0.5,b.width,b.height))}
function pb(a,b,c){a.h.clearRect(0,0,a.p.width,a.p.height);qa(a.m,function(b){ob(a,b,"#ffffff",1)});var e=[];qa(a.m,function(a){!(b<a.shape.c.x||c<a.shape.c.y||b>a.shape.c.x+a.shape.c.width||c>a.shape.c.y+a.shape.c.height)&&e.push(a)});ua(e,function(a,b){return a.shape.c.size()>b.shape.c.size()});0<e.length&&ob(a,e[0],"#fff000",1.8)};
